---
title: 'Project 2: Energy-Efficiency-Statistical-Analysis, Draft 1'
author: "Christina Mourad, Victor Um, Joe De Leon, Martin Ha"
date: "`r Sys.Date()`"
output:
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=4, fig.height=3)

```

```{r}
# packages

# install.packages(c("readxl", "ggplot2", "dplyr", "tidyr", "purrr"))
library(ggplot2)
library(dplyr)
library(tidyr)
library(readxl)
library(purrr)
```

1. Exploring Data

- Data Loading and Variable renaming:

```{r}

# packages: readlxl, dplyr, ggplot2, tidyr, e1071

dataset <- read_excel("/Users/martinha/Desktop/Math 444/Energy-Efficiency-Statistical-Analysis/ENB2012_data.xlsx")

dataset <- dataset %>%
  rename('X1_Relative_Compactness' = X1, 'X2_Surface_Area' = X2, 'X3_Wall_Area' = X3, 'X4_Roof_Area' = X4, 'X5_Overall_Height' = X5, 'X6_Orientation' = X6, 'X7_Glazing_Area' = X7, 'X8_Glazing_Area_Distribution' = X8, 'Y1_Heating_Load' = Y1, 'Y2_Cooling_Load' = Y2)
summary(dataset)
```

 - Understanding distribution:
 
```{r}

plots <- map(names(dataset), ~ {
  if (is.numeric(dataset[[.x]])) {
    # Freedman-Diaconis rule
    IQR_value <- IQR(dataset[[.x]], na.rm = TRUE)
    binwidth <- 2 * IQR_value / length(na.omit(dataset[[.x]]))^(1/3)
    
    ggplot(dataset, aes(x = !!sym(.x))) +  # Use sym() for tidy evaluation
      geom_histogram(binwidth = binwidth, fill = "blue", color = "black", alpha = 0.7) +
      labs(title = paste("Histogram of", .x),
           x = .x,
           y = "Frequency")
  }
})

# Print plots
walk(plots, print)

```
